<h2 mat-dialog-title>{{ data.title }}</h2>

<mat-dialog-content class="modal-content">

  <!-- DESCRIPCIÓN -->
  <section class="section-block" *ngIf="data.description">
    <h3 class="section-title">Descripción</h3>
    <p class="section-text">{{ data.description }}</p>
  </section>

  <!-- FECHA / TIPO -->
  <section class="section-block">
    <h3 class="section-title">Detalles</h3>

    <div class="detail-row">
      <strong>Tipo:</strong> {{ data.eventType }}
    </div>

    <div class="detail-row" *ngIf="data.dateLabel">
      <strong>Fecha:</strong> {{ data.dateLabel }}
    </div>
  </section>

  <!-- TAGS -->
  <section class="section-block" *ngIf="data.tags?.length">
    <h3 class="section-title">Etiquetas</h3>

    <div class="tag-list">
      <span
        *ngFor="let t of data.tags"
        class="tag-item"
        [ngStyle]="getTagStyle(t)">
        {{ t.label }}
      </span>
    </div>
  </section>

  <!-- PUNTOS DE ACCESO -->
  <section class="section-block" *ngIf="data.accessPoints?.length">
    <h3 class="section-title">Puntos de acceso</h3>

    <div class="ap-card" *ngFor="let ap of data.accessPoints">
      <div class="ap-title">
        <mat-icon class="ap-icon">location_on</mat-icon>
        {{ ap.name }}
      </div>

      <div class="ap-detail">
        <strong>Tipo:</strong>
        {{ getAccessPointType(ap.typeId) }}
      </div>

      <div class="ap-detail" *ngIf="ap.description">
        <strong>Descripción:</strong>
        {{ ap.description }}
      </div>

      <div class="ap-detail" *ngIf="ap.code">
        <strong>Código:</strong>
        {{ ap.code }}
      </div>

      <div class="ap-qr" *ngIf="ap.qrCodeKey">
        <img [src]="'data:image/png;base64,' + ap.qrCodeKey" alt="QR Code" class="qr-image">
        <div class="qr-actions">
          <button mat-mini-fab color="primary" (click)="enlargeQr(ap.qrCodeKey)" matTooltip="Ampliar QR">
            <mat-icon>zoom_in</mat-icon>
          </button>
          <button mat-mini-fab color="accent" (click)="downloadQr(ap.qrCodeKey, ap.name + '_qr.png')" matTooltip="Descargar QR">
            <mat-icon>download</mat-icon>
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- JORNADAS -->
  <section class="section-block" *ngIf="data.schedules?.length">
    <h3 class="section-title">Jornadas</h3>

    <div class="schedule-card" *ngFor="let s of data.schedules">
      <div class="schedule-title">
        <mat-icon class="schedule-icon">schedule</mat-icon>
        {{ s.name }}
      </div>

      <div class="schedule-detail">
        <strong>Hora inicio:</strong> {{ s.startTime }}
      </div>

      <div class="schedule-detail">
        <strong>Hora fin:</strong> {{ s.endTime }}
      </div>

      <div class="schedule-detail" *ngIf="s.days?.length">
        <strong>Días:</strong> {{ s.days.join(', ') }}
      </div>
    </div>
  </section>

  <div *ngIf="enlargedQr" class="qr-overlay" (click)="enlargedQr = null">
    <img [src]="'data:image/png;base64,' + enlargedQr" alt="QR Code Ampliado" class="qr-enlarged">
  </div>

</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button mat-dialog-close>Cerrar</button>
</mat-dialog-actions>
