<div class="detail-container">
  <div class="header">
    <div class="header-content">
      <div class="title-section">
        <mat-icon class="title-icon">business</mat-icon>
        <h1>{{ unitDetail?.name || 'Detalle de Unidad Organizativa' }}</h1>
      </div>
      <button mat-stroked-button (click)="goBack()" class="back-btn">
        <mat-icon>close</mat-icon>
        Cerrar
      </button>
    </div>
  </div>

  <div class="unit-info" *ngIf="unitDetail">
    <div class="info-card">
      <div class="card-header">
        <mat-icon class="card-icon">info</mat-icon>
        <h2>Información General</h2>
      </div>
      <div class="info-grid">
        <div class="info-item">
          <mat-icon class="info-icon">label</mat-icon>
          <div>
            <span class="label">Nombre</span>
            <span class="value">{{ unitDetail.name }}</span>
          </div>
        </div>
        <div class="info-item">
          <mat-icon class="info-icon">description</mat-icon>
          <div>
            <span class="label">Descripción</span>
            <span class="value">{{ unitDetail.description || 'Sin descripción' }}</span>
          </div>
        </div>
        <div class="info-item">
          <mat-icon class="info-icon">tag</mat-icon>
          <div>
            <span class="label">Código</span>
            <span class="value">{{ unitDetail.code || 'Sin código' }}</span>
          </div>
        </div>
        <div class="info-item">
          <mat-icon class="info-icon">store</mat-icon>
          <div>
            <span class="label">Sucursales</span>
            <span class="value">{{ unitDetail.branchesCount || 0 }}</span>
          </div>
        </div>
        <div class="info-item">
          <mat-icon class="info-icon">account_tree</mat-icon>
          <div>
            <span class="label">Divisiones</span>
            <span class="value">{{ unitDetail.divisionsCount || 0 }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="branches-section">
    <div class="section-header">
      <div class="section-title">
        <mat-icon class="section-icon">storefront</mat-icon>
        <h2>Sucursales Asignadas</h2>
      </div>
      <div class="assign-form" [formGroup]="assignForm">
        <mat-form-field appearance="outline" class="assign-field">
          <mat-label>
            <mat-icon class="field-icon">add_business</mat-icon>
            Agregar Sucursal
          </mat-label>
          <mat-select formControlName="branchId">
            <mat-option *ngFor="let branch of availableBranches" [value]="branch.id">
              <mat-icon class="option-icon">store</mat-icon>
              {{ branch.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <button mat-raised-button color="primary" (click)="assignBranch()" [disabled]="assignForm.invalid" class="assign-btn">
          <mat-icon>add</mat-icon>
          Agregar
        </button>
      </div>
    </div>

    <div class="table-container" *ngIf="assignedBranches.length; else noBranches">
      <table mat-table [dataSource]="assignedBranches" class="mat-elevation-z8">
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef>
            <mat-icon class="header-icon">store</mat-icon>
            Nombre de Sucursal
          </th>
          <td mat-cell *matCellDef="let branch">
            <mat-icon class="cell-icon">store</mat-icon>
            {{ branch.name }}
          </td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Acciones</th>
          <td mat-cell *matCellDef="let branch">
            <button mat-icon-button color="warn" (click)="removeBranch(branch.id)" matTooltip="Remover sucursal" class="remove-btn">
              <mat-icon>remove_circle</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </div>

    <ng-template #noBranches>
      <div class="no-data">
        <mat-icon class="no-data-icon">store_mall_directory</mat-icon>
        <h3>No hay sucursales asignadas</h3>
        <p>Agrega sucursales usando el formulario arriba</p>
      </div>
    </ng-template>
  </div>
</div>