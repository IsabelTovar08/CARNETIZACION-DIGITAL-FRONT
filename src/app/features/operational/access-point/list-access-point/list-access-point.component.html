<app-generic-list-card
  [title]="'Puntos de Acceso'"
  [dataSourceInput]="accessPoints"
  [pageSize]="6"
  [customTemplates]="{ meta: metaTpl }"
  (onCreate)="create()"
  (onView)="view($event)"
  (onEdit)="edit($event)"
  (onDelete)="remove($event)"
  (onToggleStatus)="toggle($event)">
</app-generic-list-card>

<ng-template #metaTpl let-ap>
  <div class="ap-meta">
    <span *ngIf="ap.description">{{ ap.description }}</span>
    <div *ngIf="ap.qrCodeKey" class="ap-qr-small">
      <!-- Mostrar imagen del QR -->
      <img
        *ngIf="getQrUrl(ap.qrCodeKey)"
        [src]="getQrUrl(ap.qrCodeKey)"
        alt="QR Code"
        class="qr-small"
        (click)="enlargeQr(ap.qrCodeKey)"
        title="Click para ampliar">

      <!-- Loading mientras se genera -->
      <div *ngIf="!getQrUrl(ap.qrCodeKey)" class="qr-loading-small">
        <mat-spinner diameter="20"></mat-spinner>
      </div>
    </div>
  </div>
</ng-template>

<!-- Modal para QR agrandado -->
<div *ngIf="enlargedQr" class="qr-modal-overlay" (click)="enlargedQr = null">
  <div class="qr-modal-content" (click)="$event.stopPropagation()">
    <img [src]="enlargedQr" alt="QR Agrandado" class="qr-large">
    <button mat-icon-button class="close-btn" (click)="enlargedQr = null">
      <mat-icon>close</mat-icon>
    </button>
  </div>
</div>
