<!-- Encabezado -->
<div class="events-header">
  <h2>Eventos</h2>
</div>

<!-- Filtros -->
<div class="filters-container">
  <mat-form-field appearance="outline" class="filter-field">
    <mat-label>Estado</mat-label>
    <mat-select [value]="selectedStatus" (selectionChange)="onStatusChange($event.value)">
      <mat-option *ngFor="let status of statusOptions" [value]="status">
        {{ status }}
      </mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field appearance="outline" class="filter-field">
    <mat-label>Tipo de Evento</mat-label>
    <mat-select [value]="selectedType" (selectionChange)="onTypeChange($event.value)">
      <mat-option *ngFor="let type of typeOptions" [value]="type">
        {{ type }}
      </mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field appearance="outline" class="filter-field">
    <mat-label>Visibilidad</mat-label>
    <mat-select [value]="selectedVisibility" (selectionChange)="onVisibilityChange($event.value)">
      <mat-option *ngFor="let visibility of visibilityOptions" [value]="visibility">
        {{ visibility }}
      </mat-option>
    </mat-select>
  </mat-form-field>
</div>

<!-- LISTA DE TARJETAS (usa tu componente real) -->
<app-generic-list-card
  [title]="'Eventos'"
  [buttonSave]="true"
  [dataSourceInput]="listEvents"
  [pageSize]="9"
  [customTemplates]="{
    'meta': metaTpl,
    'actions': actionsTpl
  }"
  (onCreate)="create()"
  (onView)="view($event)"
  (onEdit)="edit($event)"
  (onDelete)="remove($event)"
  (onToggleStatus)="toggle($event)"
  (onMoreTags)="openTagsModal($event)">
</app-generic-list-card>

<!-- Mensaje cuando no hay eventos -->
<div *ngIf="!listEvents || listEvents.length === 0" class="no-results">
  <mat-icon>search_off</mat-icon>
  <h3>No se encontraron eventos</h3>
  <p>Intenta ajustar los filtros para ver más resultados.</p>
</div>

<ng-template #metaTpl let-e>
  <span>{{ e.city || 'Sede principal' }} | {{ e.dateLabel }}</span>
</ng-template>

<ng-template #actionsTpl let-e>

  <!-- Etiquetas -->
  <div class="custom-tags-container">
    <mat-chip-set>

      <!-- Tags visibles -->
      <mat-chip *ngFor="let t of e.tags">
        {{ t.label || t }}
      </mat-chip>

      <!-- Botón +más -->
      <mat-chip
        *ngIf="e.showMoreCount > 0"
        class="more-chip"
        (click)="openTagsModal(e)">
        +{{ e.showMoreCount }} más
      </mat-chip>
    </mat-chip-set>
  </div>

  <!-- Botones de acción de mirar asistencia, y de mas informacion -->
<div class="button-container compact">
  <button mat-icon-button color="primary" matTooltip="Más información" (click)="view(e)">
    <mat-icon>info</mat-icon>
  </button>

  <button mat-icon-button color="accent" matTooltip="Ver asistencias" (click)="viewAttendees(e)">
    <mat-icon>groups</mat-icon>
  </button>

  <button mat-icon-button matTooltip="Más acciones" [matMenuTriggerFor]="menu">
    <mat-icon>more_vert</mat-icon>
  </button>
</div>



  <span class="spacer"></span>

  <!-- Menú acciones -->
  <button mat-icon-button [matMenuTriggerFor]="menu" matTooltip="Más acciones">
    <mat-icon>more_vert</mat-icon>
  </button>

  <mat-menu #menu="matMenu">
    <button mat-menu-item (click)="edit(e)">
      <mat-icon>edit</mat-icon>
      Editar
    </button>
    <button mat-menu-item (click)="remove(e)">
      <mat-icon>delete</mat-icon>
      Eliminar
    </button>
    <button mat-menu-item (click)="toggle(e)">
      <mat-icon>{{ e.isDeleted ? 'toggle_on' : 'toggle_off' }}</mat-icon>
      {{ e.isDeleted ? 'Activar' : 'Desactivar' }}
    </button>
  </mat-menu>

</ng-template>
